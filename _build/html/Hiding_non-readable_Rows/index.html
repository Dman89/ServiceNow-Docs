

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Hiding non-readable Rows in List View &mdash; ServiceNow Documentation 0.01 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ServiceNow Documentation 0.01 documentation" href="../index.html"/>
        <link rel="next" title="Instanbul Notes" href="../Istanbul_Notes/index.html"/>
        <link rel="prev" title="Content Management System" href="../CMS/index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ServiceNow Documentation
          

          
          </a>

          
            
            
              <div class="version">
                0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../CMS/index.html">Content Management System</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hiding non-readable Rows in List View</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#separating-readable-projects-by-department">Separating Readable Projects By Department</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-before-query-business-rule">Creating a Before Query Business Rule</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Istanbul_Notes/index.html">Instanbul Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reference_Qualifiers/index.html">Reference Qualifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../REST_Messages/index.html">REST Message v2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Sending_Attachments_via_REST/index.html">Sending Attachments via REST</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Service_Portal/index.html">Service Portal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Slack_Questions/index.html">Slack Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Time_Cards/index.html">Time Card Modifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Variable_Sets/index.html">Working With Variable Sets</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ServiceNow Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Hiding non-readable Rows in List View</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/Hiding_non-readable_Rows/index.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hiding-non-readable-rows-in-list-view">
<h1>Hiding non-readable Rows in List View<a class="headerlink" href="#hiding-non-readable-rows-in-list-view" title="Permalink to this headline">¶</a></h1>
<div class="myownstyle admonition">
<p class="first admonition-title">Row Level Security and On Query Business Rules</p>
<blockquote class="last">
<div><div class="line-block">
<div class="line"><br /></div>
</div>
</div></blockquote>
</div>
<div class="section" id="separating-readable-projects-by-department">
<h2>Separating Readable Projects By Department<a class="headerlink" href="#separating-readable-projects-by-department" title="Permalink to this headline">¶</a></h2>
<p>If you ever try placing security by record (or by row), your users may start seeing lists views with a count of Rows removed by Securiy contraints.
Even worse they may think there are no more records, when records can easily be on the first and last page with any number of removed rows in between.</p>
<a class="reference internal image-reference" href="../_images/Constraints.JPG"><img alt="../_images/Constraints.JPG" src="../_images/Constraints.JPG" style="width: 100%;" /></a>
<div class="section" id="creating-a-before-query-business-rule">
<h3>Creating a Before Query Business Rule<a class="headerlink" href="#creating-a-before-query-business-rule" title="Permalink to this headline">¶</a></h3>
<p>The query created in the Business Rule can be thought of as a filter.  So let&#8217;s say one requirement is to allow anyone from the InfoSec Department to see any
Contract record.  We would start the Business Rule, by wrapping the filter with an if statement.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">gs</span><span class="p">.</span><span class="nx">hasRole</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">userIsInInfoSec</span><span class="p">())</span> <span class="p">{</span>
  <span class="c1">// Add filter query here</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">userIsInInfoSec</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//Normal Glide Record query to see if user&#39;s Dept is InfoSec</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Next, we need to apply the query.  Let&#8217;s say there&#8217;s a department field on each contract and if a user is in the same department as the one listed in contracts then they
should be able to view it.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">gs</span><span class="p">.</span><span class="nx">hasRole</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">userIsInInfoSec</span><span class="p">())</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">uID</span> <span class="o">=</span> <span class="nx">gs</span><span class="p">.</span><span class="nx">getUserID</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">uGR</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s2">&quot;sys_user&quot;</span><span class="p">);</span>
  <span class="nx">uGR</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">uID</span><span class="p">);</span>

  <span class="nx">current</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;department&#39;</span><span class="p">,</span> <span class="nx">uGR</span><span class="p">.</span><span class="nx">department</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>What the query is doing here is returning only records that match department with the current user&#8217;s department.  These will be the only records that will show in list view and will
remove the security constraints, as long as they have security rights.  Below, we are going to add another query where all contracts in the &#8220;Guest&#8221; department can be viewed as well.</p>
<blockquote>
<div><div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="nx">gs</span><span class="p">.</span><span class="nx">hasRole</span><span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">userIsInInfoSec</span><span class="p">())</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">uID</span> <span class="o">=</span> <span class="nx">gs</span><span class="p">.</span><span class="nx">getUserID</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">uGR</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">GlideRecord</span><span class="p">(</span><span class="s2">&quot;sys_user&quot;</span><span class="p">);</span>
  <span class="nx">uGR</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">uID</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">q</span> <span class="o">=</span> <span class="nx">current</span><span class="p">.</span><span class="nx">addQuery</span><span class="p">(</span><span class="s1">&#39;department&#39;</span><span class="p">,</span> <span class="nx">uGR</span><span class="p">.</span><span class="nx">department</span><span class="p">);</span>
  <span class="nx">q</span><span class="p">.</span><span class="nx">addOrCondition</span><span class="p">(</span><span class="s1">&#39;department&#39;</span><span class="p">,</span> <span class="s1">&#39;Guest&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Istanbul_Notes/index.html" class="btn btn-neutral float-right" title="Instanbul Notes" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../CMS/index.html" class="btn btn-neutral" title="Content Management System" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Mark Carter.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.01',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>